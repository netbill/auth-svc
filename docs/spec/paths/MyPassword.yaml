patch:
  tags:
    - accounts
  summary: Update password
  description: >
    Updates the password of the authenticated account.

    **401 Unauthorized** is returned when credentials are invalid, the session is invalid,
    or the old password is incorrect.
    **403 Forbidden** is returned when the initiator is blocked or password change is temporarily restricted.
  security:
    - BearerAuth: [ ]
  requestBody:
    required: true
    content:
      application/json:
        schema:
          $ref: '../components/schemas/requests/UpdatePassword.yaml'
  responses:
    '204':
      description: Password successfully updated

    '400':
      description: >
        Bad Request. Request body is invalid or the new password does not meet requirements.
        Check the `errors` array for details.
      content:
        application/json:
          schema:
            $ref: '../components/schemas/responses/Errors.yaml'
          examples:
            passwordNotAllowed:
              summary: password is not allowed
              value:
                errors:
                  - status: 400
                    title: Bad Request
                    code: VALIDATION_ERROR
                    detail: password is not allowed
                    source:
                      pointer: /data/attributes/password

    '401':
      description: >
        Unauthorized. Invalid credentials, invalid session, user not found, or invalid password.
        Check the `detail` field in the response for more information.
      content:
        application/json:
          schema:
            $ref: '../components/schemas/responses/Errors.yaml'
          examples:
            failedToGetUserFromContext:
              summary: failed to get user from context
              value:
                errors:
                  - status: 401
                    title: Unauthorized
                    code: UNAUTHORIZED
                    detail: failed to get user from context
            userNotFound:
              summary: failed to update password user not found
              value:
                errors:
                  - status: 401
                    title: Unauthorized
                    code: UNAUTHORIZED
                    detail: failed to update password user not found
            sessionInvalid:
              summary: initiator session is invalid
              value:
                errors:
                  - status: 401
                    title: Unauthorized
                    code: UNAUTHORIZED
                    detail: initiator session is invalid
            invalidPassword:
              summary: invalid password
              value:
                errors:
                  - status: 401
                    title: Unauthorized
                    code: UNAUTHORIZED
                    detail: invalid password

    '403':
      description: >
        Forbidden. Initiator is blocked or password cannot be changed yet.
        Check the `detail` field in the response for more information.
      content:
        application/json:
          schema:
            $ref: '../components/schemas/responses/Errors.yaml'
          examples:
            initiatorBlocked:
              summary: initiator is blocked
              value:
                errors:
                  - status: 403
                    title: Forbidden
                    code: FORBIDDEN
                    detail: initiator is blocked
            cannotChangePasswordYet:
              summary: cannot change password yet
              value:
                errors:
                  - status: 403
                    title: Forbidden
                    code: FORBIDDEN
                    detail: cannot change password yet

    '500':
      description: Internal Server Error
      content:
        application/json:
          schema:
            $ref: '../components/schemas/responses/Errors.yaml'
